📁 현재 파일 업로드 시스템 분석
🔍 현재 상황 (attached_assets 폴더 분석)
파일 보관 방식:

✅ 모든 업로드 파일이 영구 저장됨 - 삭제되지 않고 계속 누적
✅ 고유 타임스탬프 ID로 파일명 생성 (예: _1754095237715.png)
✅ 원본 파일명 + 타임스탬프 조합으로 중복 방지
문제점:

대용량 PDF: OC-합본_(Korean) - 복사본_1751814861224.pdf (31MB)
중복 BOM 파일들: 동일한 파일이 4개 버전으로 저장
대량 스크린샷: 70개+ 이미지 파일 (2-220KB 각각)
🛠️ 파일 관리 최적화 방안
1. 임시 업로드 vs 영구 보관 구분
A. 데이터 정리용 (일회성)

📂 용도: 데이터 마이그레이션, 일회성 업로드
📝 예시: OC-합본 PDF, 초기 데이터 정리용 엑셀
🗑️ 처리: 작업 완료 후 즉시 삭제
B. 업무용 엑셀 (최신만 유지)

📂 용도: BOM 업로드, 제품마스터, 재고동기화
📝 예시: BOM 설치가이드별 필요부품 수량.xlsx
🔄 처리: 새 파일 업로드 시 이전 파일 자동 삭제
C. 증거자료 (보관 필요)

📂 용도: 업무 진행 스크린샷, 오류 리포트
📝 예시: 시스템 오류 화면, 작업 완료 증명
💾 처리: 일정 기간 보관 (예: 30일)
2. 스마트 파일 관리 시스템 구현
A. 파일 카테고리 자동 분류

// 파일 타입별 보관 정책
const fileRetentionPolicy = {
  'temp': { days: 1, autoDelete: true },      // 임시 파일
  'bom': { maxCount: 1, keepLatest: true },   // BOM 파일
  'master': { maxCount: 1, keepLatest: true }, // 마스터 데이터
  'screenshot': { days: 30, autoDelete: true }, // 스크린샷
  'backup': { days: 90, autoDelete: false }    // 백업 파일
};
B. 자동 정리 스케줄러

// 매일 자정 실행
cron.schedule('0 0 * * *', () => {
  cleanupExpiredFiles();
  removeDuplicateBOMFiles();
  compressOldScreenshots();
});
3. 업로드 시점별 처리 방안
A. BOM 업로드 시

✅ 새 파일 업로드
🗑️ 이전 BOM 파일 자동 삭제
📊 변경 사항 로그 기록
B. 제품마스터 업로드 시

✅ 새 파일 업로드
🗑️ 이전 마스터 파일 자동 삭제
🔄 데이터베이스 동기화
C. 재고 동기화 업로드 시

✅ 새 파일 업로드
💾 이전 파일을 백업 폴더로 이동 (최대 3개)
🗑️ 3개 초과 시 가장 오래된 것 삭제
4. 파일 크기 최적화
A. 이미지 자동 압축

📷 PNG → WebP 변환 (70% 크기 감소)
📐 해상도 자동 조정 (최대 1920px)
🗜️ 품질 최적화 (80% 품질 유지)
B. 엑셀 파일 최적화

📊 불필요한 시트 제거
🧹 빈 행/열 정리
💾 압축 저장 옵션 적용
📋 구체적 구현 방안
1단계: 즉시 정리 (수동)
# 대용량 PDF 제거 (31MB 절약)
# 중복 BOM 파일 정리 (60KB 절약)
# 오래된 스크린샷 선별 삭제 (2-3MB 절약)
2단계: 자동화 시스템 구현
// 업로드 시 자동 분류 및 정리
interface FileUploadHandler {
  category: 'temp' | 'bom' | 'master' | 'screenshot' | 'backup';
  retentionDays?: number;
  maxCount?: number;
  autoOptimize: boolean;
}
3단계: 모니터링 대시보드
📊 파일 사용량 현황
📈 카테고리별 저장 공간
🗑️ 자동 정리 현황
⚠️ 용량 경고 알림
🎯 예상 효과
현재: 37MB (attached_assets)
최적화 후: 5-8MB 예상

즉시 효과: 대용량 PDF 제거로 31MB 절약
지속 효과: 자동 정리로 향후 용량 증가 억제
성능 향상: 파일 검색 및 백업 속도 개선
⚠️ 주의사항
백업 정책: 중요 파일 삭제 전 백업 확인
사용자 알림: 파일 자동 삭제 전 사용자 통지
복구 기능: 실수 삭제 시 복구 가능한 휴지통 기능
권한 관리: 파일 삭제 권한을 관리자로 제한